Some of this code is really horrific, viewer discretion is advised.
